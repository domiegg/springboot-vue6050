(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c0b00"],{"439d":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("shead",{attrs:{headid:e.$route.query.headid}}),t("div",{staticClass:"wrap round-block"},[t("el-steps",{attrs:{space:200,active:1,"finish-status":"success"}},[t("el-step",{attrs:{title:"加入购物车"}}),t("el-step",{attrs:{title:"填写收货地址"}}),t("el-step",{attrs:{title:"付款"}})],1),t("div",{staticClass:"shopcart-box"},[t("div",{staticClass:"hd"},[e._v("购物车")]),t("div",{staticClass:"bd"},[t("table",{staticClass:"table table-striped table-hover table-bordered"},[e._m(0),t("tbody",e._l(e.cartItems,(function(s){return t("tr",{key:s.id},[t("td",[t("img",{attrs:{width:"120",height:"120",src:e.hostHead+s.value.tupian}})]),t("td",[e._v(e._s(s.value.name))]),t("td",[e._v(" "+e._s(s.value.count)+" ")]),t("td",[e._v(e._s(s.value.price)+"¥")]),t("td",[e._v(e._s(s.value.count*s.value.price)+"¥")])])})),0)])])]),t("div",{staticClass:"total-price-panel"},[t("div",{staticClass:"pull-left"},[e._v(" 总金额:"),t("span",{staticClass:"price"},[e._v(e._s(e.totalPrice)+"¥")])]),t("div",{staticClass:"pull-right"})]),t("div",{staticClass:"address-list clearfix"},[t("div",{staticClass:"plus-address"},[t("el-button",{attrs:{type:"danger",icon:"el-icon-plus"},on:{click:e.showAddressdlg}},[e._v("新增地址")])],1),t("div",e._l(e.listReceaddress,(function(s,a){return t("ul",{staticClass:"address-info",class:{selected:a==e.selectedIndex},on:{click:function(t){return e.checkAddress(a)}}},[t("div",{staticClass:"add-title"},[e._v(" "+e._s(s.title)+" ")]),t("li",[e._v(e._s(s.shr))]),t("li",[e._v(e._s(s.addinfo))]),t("li",[e._v(e._s(s.mobile))]),t("li",[e._v(e._s(s.postcode))])])})),0)]),t("table",{staticClass:"smart-table",attrs:{width:"100%",border:"1"}},[t("tr",[t("td",{staticClass:"tlabel",attrs:{width:"15%",align:"right",height:"34px"}},[e._v(" 说明: ")]),t("td",[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.remark,expression:"remark"}],staticStyle:{width:"500px",height:"80px"},attrs:{name:"des"},domProps:{value:e.remark},on:{input:function(t){t.target.composing||(e.remark=t.target.value)}}})])]),t("tr",[t("td",{attrs:{colspan:"2",height:"34px"}},[t("el-button-group",[t("el-button",{attrs:{type:"warning",icon:"el-icon-plus"},on:{click:e.newOrderHandler}},[e._v("下单结算")]),t("a",{staticClass:"el-button--primary el-button",attrs:{href:"/e/index.jsp"}},[e._v("继续选物品")])],1)],1)])])],1),t("bottom"),t("el-dialog",{attrs:{title:"收货地址管理",visible:e.addressdlg},on:{"update:visible":function(t){e.addressdlg=t}}},[t("div",{staticClass:"form-group"},[t("label",[e._v("收货人")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.receaddress.shr,expression:"receaddress.shr"}],staticClass:"form-control",attrs:{type:"text",name:"shr",placeholder:"收货人"},domProps:{value:e.receaddress.shr},on:{input:function(t){t.target.composing||e.$set(e.receaddress,"shr",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[e._v("联系电话")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.receaddress.mobile,expression:"receaddress.mobile"}],staticClass:"form-control",attrs:{type:"text",name:"mobile",placeholder:"联系电话"},domProps:{value:e.receaddress.mobile},on:{input:function(t){t.target.composing||e.$set(e.receaddress,"mobile",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[e._v("邮编")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.receaddress.postcode,expression:"receaddress.postcode"}],staticClass:"form-control",attrs:{type:"text",name:"postcode",placeholder:"邮编"},domProps:{value:e.receaddress.postcode},on:{input:function(t){t.target.composing||e.$set(e.receaddress,"postcode",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[e._v("地址")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.receaddress.addinfo,expression:"receaddress.addinfo"}],staticClass:"form-control",attrs:{type:"text",name:"addinfo",placeholder:"地址"},domProps:{value:e.receaddress.addinfo},on:{input:function(t){t.target.composing||e.$set(e.receaddress,"addinfo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[e._v("备注")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.receaddress.title,expression:"receaddress.title"}],staticClass:"form-control",attrs:{type:"text",name:"title",placeholder:"请输入标题"},domProps:{value:e.receaddress.title},on:{input:function(t){t.target.composing||e.$set(e.receaddress,"title",t.target.value)}}})]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveReceadd}},[e._v("确 定")]),t("el-button",{on:{click:function(t){e.addressdlg=!1}}},[e._v("取 消")])],1)])],1)},r=[function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("商品")]),t("th",[e._v("名称")]),t("th",[e._v("数量")]),t("th",[e._v("单价(元)")]),t("th",[e._v("金额(元)")])])])}],d=(s("5384"),s("e937"),s("3869")),i=(s("c907"),s("f558")),l=s("4a62"),o={name:"xiadan",components:{Bottom:d["default"],Shead:i["default"],loginmodal:l["default"]},data(){return{cartItems:[],hostHead:this.$app.contextPath,remark:"",over:!1,openLogin:!1,addressdlg:!1,selectedIndex:0,receaddress:{shr:"",mobile:"",hyid:"",postcode:"",addinfo:"",title:""},listReceaddress:[]}},methods:{load(){let e=new SmartStorage,t=e.getItems();null!=t&&t.forEach(e=>{e.value.selected&&this.cartItems.push(e)}),this.getAddressList()},async showAddressdlg(){this.addressdlg=!0,this.receaddress.shr=this.huiyuan.name,this.receaddress.mobile=this.huiyuan.mobile},checkAddress(e){this.selectedIndex=e},async getAddressList(){let e="admin/receaddress/list",{data:t}=await this.$http.post(e,{hyid:this.huiyuan.id,ispaged:-1});null!=t&&t.stateCode<0?this.$message.error(t.des):(this.listReceaddress=t.data,null!=this.listReceaddress&&this.listReceaddress.length>0&&(this.addrid=this.listReceaddress[0].id))},async saveReceadd(){let e="admin/receaddress/save";if(""==this.receaddress.shr)return void this.$message.error("请填写收货人地址");if(""==this.receaddress.mobile)return void this.$message.error("请填写手机号");if(""==this.receaddress.postcode)return void this.$message.error("请填写邮编");if(""==this.receaddress.addinfo)return void this.$message.error("请填写地址");if(""==this.receaddress.title)return void this.$message.error("请填写备注");this.receaddress.hyid=this.huiyuan.id;let{data:t}=await this.$http.post(e,this.receaddress);null!=t&&t.stateCode<0?this.$message.error(t.des):(this.$message.success("保存成功"),this.addressdlg=!1,this.getAddressList())},async newOrderHandler(){if(null==this.listReceaddress||0==this.listReceaddress.length)return void this.$alert("请填写收货地址","系统提示",{confirmButtonText:"确定"});let e=[];this.cartItems.forEach(t=>{t.value.selected&&e.push({spid:t.value.id,count:t.value.count,price:t.value.price})});let t=this.listReceaddress[this.selectedIndex].id,{data:s}=await this.$http.post("admin/shorder/save",{purchaser:this.huiyuan.id,psstyle:"网购",remark:this.remark,addid:t,goods:e},{emulateJSON:!1});null!=s&&s.stateCode<0||null!=s&&s.stateCode<0?this.$message.error(s.des):(console.log("res=",s),null!=s&&s.stateCode>0&&((new SmartStorage).clear(),this.$router.push("/e/payment?id="+s.data.id)))}},computed:{totalPrice(){if(null==this.cartItems||0==this.cartItems.length)return 0;let e=0;return this.cartItems.forEach(t=>{t.value.selected&&(e+=t.value.count*t.value.price)}),e},huiyuan(){return this.$app.mycas.getAccount(this.$app.mycas.huiyuan_key)}},created(){this.load()}},c=o,n=s("829d"),u=Object(n["a"])(c,a,r,!1,null,"f3722e32",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0c0b00.5dd24df8.js.map