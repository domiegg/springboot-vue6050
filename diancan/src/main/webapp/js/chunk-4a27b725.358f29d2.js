(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a27b725","chunk-707e9921","chunk-2d0a4b99","chunk-2d0a47f7","chunk-2d2244d7","chunk-2d21b2be","chunk-2d229284"],{"0760":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{width:t.width,title:t.title,"close-on-click-modal":!1,visible:t.show},on:{"update:visible":t.closeHandler}},[t.reload?e(t.view,{tag:"component",attrs:{params:t.params},on:{close:t.closeHandler}}):t._e()],1)},i=[],r={name:"mydialog",data(){return{view:null,reload:!0,params:{}}},props:{url:{type:String,require:!0},width:{type:String,default:"80%"},xdata:{type:Object},title:{type:String,default:"详情"},show:{type:Boolean,require:!0}},methods:{loadComponent(t){return s("8673")("./"+t)},getParam(){if(-1==this.url.indexOf("?"))return{};let t=this.url.split("?")[1],e=new Object,s=t.split("&");for(var a=0;a<s.length;a++)e[s[a].split("=")[0]]=unescape(s[a].split("=")[1]);e=Object.assign(e,this.xdata),console.log("params",e),this.params=e},closeHandler(t){console.log("执行关闭"),this.$emit("update:show",t),this.$emit("close",!0)}},watch:{url:{handler(t){if(null==t)return;console.log("newVal",t);let e=t;-1!=t.indexOf("?")&&(e=t.split("?")[0]),this.getParam(),console.log("this.params",this.params),e.startsWith("/")&&(e=e.substring(1)),this.loadComponent(e).then(t=>{this.view=t.default}),this.reload=!1,this.$nextTick(()=>{this.reload=!0})},immediate:!0}}},l=r,n=s("2877"),d=Object(n["a"])(l,a,i,!1,null,"48b1e5fe",null);e["default"]=d.exports},"0850":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return t.visible?e("el-dialog",{attrs:{title:"分配送餐员",visible:t.visible,width:"70%",top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.visible=e}}},[e("el-card",{staticClass:"box-card"},[e("div",{staticStyle:{margin:"22px 30px"}},[e("el-steps",{attrs:{space:200,active:3,"finish-status":"success"}},[e("el-step",{attrs:{title:"下单"}}),e("el-step",{attrs:{title:"付款"}}),e("el-step",{attrs:{title:"派送"}}),e("el-step",{attrs:{title:"收货评价"}})],1)],1),e("table",{staticClass:"smart-table",attrs:{border:"1"}},[e("tr",[e("td",{staticClass:"tlabel"},[t._v("订单编号")]),e("td",[t._v(t._s(t.order.ddno))]),e("td",{staticClass:"tlabel"},[t._v("下单时间:")]),e("td",[t._v(" "+t._s(t.order.createtime)+" ")])]),e("tr",[e("td",{staticClass:"tlabel"},[t._v("总金额")]),e("td",[t._v(t._s(t.order.totalfee)+"¥")]),e("td",{staticClass:"tlabel"},[t._v("下单人")]),e("td",[t._v(t._s(t.order.puraccount)+"("+t._s(t.order.purname)+")")])]),e("tr",[e("td",{staticClass:"tlabel"},[t._v("派送员")]),e("td",{attrs:{colspan:"3"}},[2==t.order.state?e("div",{staticStyle:{width:"300px"}},[e("el-select",{model:{value:t.zyid,callback:function(e){t.zyid=e},expression:"zyid"}},t._l(t.listUsers,(function(t){return e("el-option",{attrs:{value:t.id,label:t.realname+"---"+t.username}})})),1)],1):t._e()])])]),e("table",{staticClass:"ui-record-table",attrs:{width:"100%",border:"0",cellspacing:"0",cellpadding:"0"}},[e("thead",[e("tr",[e("th",[t._v("名称")]),e("th",[t._v("价格")]),e("th",[t._v("数量")]),e("th",[t._v("状态")])])]),e("tbody",[t._l(t.order.orderDetail,(function(s){return e("tr",[e("td",[e("img",{attrs:{width:"80",height:"80",src:t.hostHead+s.images[0]}}),t._v(" "+t._s(s.spname))]),e("td",[t._v(t._s(s.price)+"元")]),e("td",[t._v(t._s(s.count))]),e("td",[1==s.state?e("span",[t._v("待付款")]):t._e(),2==s.state?e("span",[t._v("已付款")]):t._e(),3==s.state?e("span",[t._v(" 物流号:"+t._s(s.wlno)+" ")]):t._e(),4==s.state?e("span",[t._v("已完成")]):t._e(),5==s.state?e("span",[t._v("已取消")]):t._e()])])})),e("tr",[e("td",{attrs:{colspan:"4"}},[e("el-button",{attrs:{type:"primary"},on:{click:t.dispatchHandler}},[e("i",{staticClass:"el-icon-arrow-right"}),t._v("分配")])],1)])],2)])])],1):t._e()},i=[],r={name:"shorderdetails",data(){return{visible:!1,oiid:this.$route.query.oiid,wlno:"",zyid:1,listUsers:[],hostHead:this.$app.contextPath,order:{},receaddress:null}},methods:{async show(t){if(null==t)return this.$message.error("订单信息不能为空");this.order=t,await this.getUsers(),await this.getOrderInfo(),this.visible=!0},async getUsers(){let{data:t}=await this.$http.post("admin/users/list",{ispaged:"-1",roleid:2});t.stateCode<0?this.$message.error(t.des):(this.listUsers=t.data,null!=this.listUsers&&this.listUsers.length>0&&(this.zyid=this.listUsers[0].id))},async getOrderInfo(){let{data:t}=await this.$http.post("admin/shorder/load",{id:this.order.id});t.stateCode<0?this.$message.error(t.des):(console.log("订单数据",t),this.order=t.data)},async dispatchHandler(){this.$confirm("是否要派送?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let{data:t}=await this.$http.post("admin/shorder/dispatch",{id:this.order.id,zyid:this.zyid});t.stateCode<0?this.$message.error(t.des):(this.$message.success("派送完成"),this.$emit("over"),this.visible=!1)}).catch(()=>{})},async getAddress(){let{data:t}=await this.$http.post("admin/receaddress/load",{id:this.order.addid});t.stateCode<0?this.$message.error(t.des):(this.receaddress=t.data,console.log("receaddress",this.receaddress))}},async created(){}},l=r,n=s("2877"),d=Object(n["a"])(l,a,i,!1,null,"54fa7c8d",null);e["default"]=d.exports},6821:function(t,e,s){},"8a8f":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{class:{inline:t.inline}},[e("span",{class:t.cssClass,on:{click:t.popHandler}},[t._t("default")],2),e("mydialog",{attrs:{width:t.width,show:t.showDlg,url:t.url,xdata:t.xdata,title:t.title},on:{"update:show":function(e){t.showDlg=e},close:t.closeHandler}})],1)},i=[],r=s("0760"),l={name:"PopDialogButton",data(){return{showDlg:!1}},methods:{popHandler(){this.showDlg=this.visible},closeHandler(t){this.$emit("refresh",!0)}},props:{url:{type:String,require:!0},visible:{type:Boolean,default:!0},inline:{type:Boolean,default:!0},xdata:{type:Object},title:{type:String,default:"标题"},cssClass:{type:String},width:{type:String,default:"80%"}},components:{mydialog:r["default"]},watch:{visible(t,e){this.showDlg=t}}},n=l,d=(s("e298"),s("2877")),o=Object(d["a"])(n,a,i,!1,null,"38004ee7",null);e["default"]=o.exports},bf48:function(t,e,s){"use strict";s.r(e),s.d(e,"MyFilters",(function(){return a})),s.d(e,"ModalDialogUtils",(function(){return i})),s.d(e,"VueUtil",(function(){return r})),Date.prototype.format=function(t){let e={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(let s in e)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[s]:("00"+e[s]).substr((""+e[s]).length)));return t};const a={filters:{formatDate:function(t,e="yyyy-MM-dd"){return"string"!=typeof t?t:new Date(t).format(e)}}},i={data(){return{dlgParam:{},dlgTitle:"",dlgVisible:!1}},components:{},props:{param:{type:Object}},methods:{showDlg(t,e){"string"==typeof e?null!=this.$refs[e]?this.$refs[e].show(t):this.$message.error("没找到窗体"):this.$message.error("对话框参数异常")}}};let r=function(t){this.http=t.$http,this.alert=t.$alert,this.confirm=t.$confirm,this.message=t.$message,this.isDuringDate=function(t,e){let s=new Date,a=new Date(t),i=new Date(e);return s>=a&&s<=i},this.isPasted=function(t,e){let s=new Date,a=(new Date(t),new Date(e));return s>a}}},dbf6:function(t,e,s){t.exports=s.p+"img/nodata.e33ed32a.png"},e00f:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return t.visible?e("el-dialog",{attrs:{title:"订单信息",visible:t.visible,width:"70%",top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.visible=e}}},[e("el-card",{staticClass:"box-card"},[e("div",{staticStyle:{margin:"22px 30px"}},[e("el-steps",{attrs:{space:200,active:3,"finish-status":"success"}},[e("el-step",{attrs:{title:"下单"}}),e("el-step",{attrs:{title:"付款"}}),e("el-step",{attrs:{title:"派送"}}),e("el-step",{attrs:{title:"收货评价"}})],1)],1),e("table",{staticClass:"smart-table",attrs:{border:"1"}},[e("tr",[e("td",{staticClass:"tlabel"},[t._v("订单编号")]),e("td",[t._v(t._s(t.order.ddno))]),e("td",{staticClass:"tlabel"},[t._v("下单时间:")]),e("td",[t._v(" "+t._s(t.order.createtime)+" ")])]),e("tr",[e("td",{staticClass:"tlabel"},[t._v("总金额")]),e("td",[t._v(t._s(t.order.totalfee)+"¥")]),e("td",{staticClass:"tlabel"},[t._v("下单人")]),e("td",[t._v(t._s(t.order.puraccount)+"("+t._s(t.order.purname)+")")])])]),e("table",{staticClass:"ui-record-table",attrs:{width:"100%",border:"0",cellspacing:"0",cellpadding:"0"}},[e("thead",[e("tr",[e("th",[t._v("名称")]),e("th",[t._v("价格")]),e("th",[t._v("数量")]),e("th",[t._v("状态")])])]),e("tbody",t._l(t.order.orderDetail,(function(s){return e("tr",[e("td",[e("img",{attrs:{width:"80",height:"80",src:t.hostHead+s.images[0]}}),t._v(" "+t._s(s.spname))]),e("td",[t._v(t._s(s.price)+"元")]),e("td",[t._v(t._s(s.count))]),e("td",[1==s.state?e("span",[t._v("待付款")]):t._e(),2==s.state?e("span",[t._v("已付款")]):t._e(),3==s.state?e("span",[t._v(" 物流号:"+t._s(s.wlno)+" ")]):t._e(),4==s.state?e("span",[t._v("已完成")]):t._e(),5==s.state?e("span",[t._v("已取消")]):t._e(),8==s.state?e("span",[t._v("已派送")]):t._e()])])})),0)])])],1):t._e()},i=[],r={name:"shorderdetails",data(){return{visible:!1,oiid:this.$route.query.oiid,wlno:"",hostHead:this.$app.contextPath,order:{},receaddress:null}},methods:{async show(t){if(null==t)return this.$message.error("订单信息不能为空");this.order=t,await this.getOrderInfo(),this.visible=!0},async getOrderInfo(){let{data:t}=await this.$http.post("admin/shorder/load",{id:this.order.id});t.stateCode<0?this.$message.error(t.des):(console.log("订单数据",t),this.order=t.data)},async getAddress(){let{data:t}=await this.$http.post("admin/receaddress/load",{id:this.order.addid});t.stateCode<0?this.$message.error(t.des):(this.receaddress=t.data,console.log("receaddress",this.receaddress))}},async created(){}},l=r,n=s("2877"),d=Object(n["a"])(l,a,i,!1,null,"9e5530f8",null);e["default"]=d.exports},e298:function(t,e,s){"use strict";s("6821")},ff7d:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mypanel"},[e("div",{staticClass:"hd"},[t._v(" 订单管理 ")]),e("div",{staticClass:"bd"},[e("div",{staticClass:"search-options"},[e("table",{attrs:{cellspacing:"1",width:"100%"}},[e("tbody",[e("tr",[e("td",[t._v("订单号 "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ddno,expression:"ddno"}],staticClass:"input-txt",attrs:{name:"ddno",type:"text"},domProps:{value:t.ddno},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},input:function(e){e.target.composing||(t.ddno=e.target.value)}}}),e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")])],1)])])])]),e("div",{staticClass:"clear"}),e("div",{staticClass:"action-details"},[e("el-button-group",[e("el-button",{attrs:{icon:"el-icon-check",type:"success"},on:{click:t.selectedAllHandler}},[t._v("选择")]),e("el-button",{attrs:{type:"danger",iocn:"el-icon-delete"},on:{click:t.deleteRec}},[t._v(" 删除")])],1)],1),e("div",{staticClass:"cst-list"},t._l(t.listOrder,(function(s){return e("div",{key:s.id,staticClass:"item"},[e("div",{staticClass:"title"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.rowSelected,expression:"order.rowSelected"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(s.rowSelected)?t._i(s.rowSelected,null)>-1:s.rowSelected},on:{change:function(e){var a=s.rowSelected,i=e.target,r=!!i.checked;if(Array.isArray(a)){var l=null,n=t._i(a,l);i.checked?n<0&&t.$set(s,"rowSelected",a.concat([l])):n>-1&&t.$set(s,"rowSelected",a.slice(0,n).concat(a.slice(n+1)))}else t.$set(s,"rowSelected",r)}}}),t._v(t._s(s.ddno)+" ")]),e("div",{staticClass:"subtitle"},[e("div",{staticClass:"it"},[t._v(t._s(s.createtime))]),e("div",{staticClass:"it"},[t._v("下单人:"+t._s(s.puraccount)+"("+t._s(s.purname)+")")]),e("div",{staticClass:"it"},[t._v("状态: "),1==s.state?e("span",[t._v("待付款")]):t._e(),2==s.state?e("span",[t._v("待派送")]):t._e(),3==s.state?e("span",[t._v("待评价")]):t._e(),4==s.state?e("span",[t._v("已评价")]):t._e(),5==s.state?e("span",[t._v("已取消")]):t._e(),8==s.state?e("span",[t._v("已分配送餐员")]):t._e()]),e("div",{staticClass:"it"},[2==s.state?e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.showDlg(s,"dispatchDlg")}}},[t._v("分配送餐员")]):t._e(),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showDlg(s,"infoDlg")}}},[t._v("详细")])],1)]),t._l(s.orderDetail,(function(a){return e("div",{key:a.id,staticClass:"bd clearfix"},[e("div",{staticClass:"img-area fnleft"},[e("img",{attrs:{src:t.hostHead+a.images[0]}})]),e("div",{staticClass:"des-area fnleft"},[e("div",[t._v(t._s(a.spname))]),e("div",[t._v(t._s(a.price)+"X"+t._s(a.count))]),e("div",[t._v("商户:"+t._s(a.shaccount)+t._s(a.shname))]),t._v(" 状态:"),1==a.state?e("span",[t._v("待付款")]):t._e(),2==a.state?e("span",[t._v("待派送")]):t._e(),3==a.state?e("span",[t._v("待评价")]):t._e(),4==a.state?e("span",[t._v("已评价")]):t._e(),5==a.state?e("span",[t._v("已取消")]):t._e(),8==a.state?e("span",[t._v("已分配送餐员")]):t._e()]),e("div",{staticClass:"des-area fnright"},[8==a.state?e("pop-dialog-button",{attrs:{title:"发货",inline:!1,url:"/admin/fahuo?id="+s.id,xdata:{oiid:a.id},"css-class":"action-btn"},on:{refresh:t.search}},[t._v("发货")]):t._e(),e("pop-dialog-button",{attrs:{title:"订单详情",inline:!1,url:"/huiyuan/shorderdetails?id="+s.id,"css-class":"action-btn"},on:{refresh:t.search}},[t._v("订单详情")])],1)])}))],2)})),0),null!=t.listOrder&&0==t.listOrder.length?e("div",{staticClass:"no-data"},[t._m(0)]):t._e(),e("div",{staticClass:"clear"}),e("el-pagination",{attrs:{background:"","current-page":t.pageindex,"page-sizes":[t.pagesize],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.pagesizeChange,"current-change":t.pageindexChange}})],1),e("shorderdetails",{ref:"infoDlg"}),e("Dispatchshorder",{ref:"dispatchDlg",on:{over:t.search}})],1)},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"bd"},[e("img",{staticClass:"img",attrs:{src:s("dbf6")}}),e("div",{staticClass:"text"},[t._v("暂无订单数据")])])}],r=s("8a8f"),l=s("bf48"),n=s("e00f"),d=s("0850"),o={name:"shordermanager",mixins:[l["ModalDialogUtils"]],data(){return{ddno:"",hostHead:this.$app.contextPath,selectedAll:!1,listOrder:[],listUser:[],pageindex:1,pagesize:10,total:10}},methods:{pagesizeChange:function(t){this.pagesize=t},pageindexChange:function(t){this.pageindex=t,console.log(this.pageindex),this.search()},async search(){let t="admin/shorder/list",e={currentpageindex:this.pageindex,pagesize:this.pagesize,ddno:this.ddno},{data:s}=await this.$http.post(t,e);if(null!=s){let t=s.data;this.total=t.total,null!=t.list&&t.list.forEach(t=>{t.rowSelected=!1}),this.listOrder=t.list,console.log("数据",this.listOrder)}},async deleteRec(){let t="admin/shorder/delete",e=this.listOrder.some(t=>1==t.rowSelected);if(!e)return void this.$alert("请选择需要删除的记录","系统提示",{confirmButtonText:"确定"});let s=this.listOrder.filter(t=>t.rowSelected).map(t=>t.id);console.log("ids",s);this.$confirm("是否要删除订单信息?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$http.post(t,{ids:s}).then(t=>{null!=t.data&&t.data.stateCode>0&&this.search()})}).catch(()=>{})},selectedAllHandler(){console.log(this.selectedAll),this.selectedAll=!this.selectedAll,null!=this.listOrder&&this.listOrder.forEach(t=>{t.rowSelected=this.selectedAll})}},components:{Shorderdetails:n["default"],Dispatchshorder:d["default"],PopDialogButton:r["default"]},created(){this.search()}},c=o,h=s("2877"),p=Object(h["a"])(c,a,i,!1,null,"597e4994",null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-4a27b725.358f29d2.js.map